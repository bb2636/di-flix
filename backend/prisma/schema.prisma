generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  user_id    Int     @id @default(autoincrement())
  email      String  @unique 
  password   String?
  is_member  Boolean @default(false)
  is_deleted Boolean @default(true)

  watchHistories WatchHistory[]
  wishlists      Wishlist[]
}

model Genre {
  genre_ids   Int[]    @id
  genre_name String

  contents   Content[] @relation("GenreToContent")
}

model Content {
  movie_id     Int       @id @default(autoincrement())
  title        String    @db.VarChar(255)
  description  String?   @db.Text
  genre_ids    Int[]     // 수정: category_id → genre_ids
  views        Int       @default(0)

  genre        Genre?    @relation(name: "GenreToContent", fields: [genre_ids], references: [genre_ids]) // 수정

  watchHistories WatchHistory[]
  wishlists      Wishlist[]
}

model WatchHistory {
  history_id Int      @id @default(autoincrement())
  user_id    Int?
  movie_id   Int?

  user   User?    @relation(fields: [user_id], references: [user_id])
  movie  Content? @relation(fields: [movie_id], references: [movie_id])

  timestamp DateTime @default(now())
}

model Wishlist {
  wishlist_id Int     @id @default(autoincrement())
  user_id     Int?
  movie_id    Int?

  user   User?    @relation(fields: [user_id], references: [user_id])
  movie  Content? @relation(fields: [movie_id], references: [movie_id])
}
